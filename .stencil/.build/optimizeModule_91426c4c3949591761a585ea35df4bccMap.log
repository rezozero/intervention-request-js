{"version":3,"names":["interventionRequestCss","InterventionRequest","handleLoadingCompleted","this","classnames","componentWillLoad","formats","JSON","parse","media","srcset","format","Object","assign","width","height","window","interventionRequestJS","debug","console","groupCollapsed","src","info","error","strategy","log","forEach","warn","el","groupEnd","mimeType","component","extractFileExtension","noProcess","embed","componentWillRender","baseUrl","undefined","forceIo","loading","render","h","Host","class","name","alt"],"sources":["src/components/intervention-request/intervention-request.css?tag=intervention-request&encapsulation=shadow","src/components/intervention-request/intervention-request.tsx"],"sourcesContent":[":host {\n  display: block;\n}\n","import { Element, Component, Prop, Host, h, Listen, State } from '@stencil/core'\nimport { InterventionRequestFormat, InterventionRequestMedia } from '../../intervention-request'\nimport { InterventionRequestStrategyFormat } from '../../strategies'\nimport { extractFileExtension } from '../../utils/utils'\n\n/**\n * InterventionRequest\n * @description Wrapper component\n * @author ravorona\n */\n@Component({\n    tag: 'intervention-request',\n    styleUrl: 'intervention-request.css',\n    shadow: true,\n})\nexport class InterventionRequest {\n    /**\n     * Own properties\n     */\n    private component: string\n\n    /**\n     * Component element reference\n     */\n    @Element()\n    el: HTMLElement\n\n    /**\n     * Source\n     */\n    @Prop()\n    src!: string\n\n    /**\n     * Alt attribute\n     */\n    @Prop()\n    alt: string\n\n    /**\n     * Width attribute\n     */\n    @Prop()\n    width: number\n\n    /**\n     * Height attribute\n     */\n    @Prop()\n    height: number\n\n    /**\n     * Base URL\n     */\n    @Prop()\n    baseUrl?: string\n\n    /**\n     * Media formats\n     */\n    @Prop()\n    formats?: string\n\n    /**\n     * Mime type\n     */\n    @Prop()\n    mimeType?: string\n\n    /**\n     * Embed mode\n     * use iframe if true\n     */\n    @Prop()\n    embed?: boolean\n\n    /**\n     * Strategy\n     */\n    @Prop()\n    strategy?: string\n\n    /**\n     * Force intersection observer\n     * for lazy load\n     */\n    @Prop()\n    forceIo?: boolean\n\n    /**\n     * Disable url processing.\n     * Source is directly applied as it is in attributes\n     */\n    @Prop()\n    noProcess?: boolean\n\n    /**\n     * Native lazyloading\n     * see https://caniuse.com/#feat=loading-lazy-attr\n     * see https://web.dev/native-lazy-loading/\n     *\n     * auto: Default lazy-loading behavior of the browser, which is the same as not including the attribute.\n     * lazy: Defer loading of the resource until it reaches a calculated distance from the viewport.\n     * eager: Load the resource immediately, regardless of where it's located on the page.\n     * @default auto\n     */\n    @Prop()\n    loading?: 'lazy' | 'eager' | 'auto'\n\n    @State()\n    private classnames: string = ''\n\n\n    /**\n     * Loading complete listener\n     */\n    @Listen('loadingCompleted')\n    handleLoadingCompleted (): void {\n        this.classnames += ' loaded'\n    }\n\n    private media?: InterventionRequestMedia\n\n    /**\n     * Component will load\n     * Component lifecycle method\n     * @return void\n     */\n    componentWillLoad(): void {\n        const formats = this.formats ? JSON.parse(this.formats) : false\n\n        if (formats) {\n            /**\n             * Extract the media property\n             * or build one if it doesn't exist\n             */\n            if (formats.media) {\n                this.media = formats.media\n            } else {\n                const srcset = {\n                    format: {\n                        ...formats\n                    }\n                }\n\n                this.media = [ { srcset: [ srcset ] } ]\n            }\n\n            /**\n             * Use formats dimensions\n             * for width & height\n             */\n            if (formats.width) {\n                this.width = formats.width\n            }\n\n            if (formats.height) {\n                this.height = formats.height\n            }\n        }\n\n        if (window.interventionRequestJS && window.interventionRequestJS.debug) {\n            console.groupCollapsed('%cIntervention Request', 'font-size: 10px; font-weight: normal; background: #673ab7; color: #fff; padding: 2px 4px; border-radius: 3px')\n\n            if (this.src) {\n                console.info('source: %s', this.src)\n            } else {\n                console.error('src attribute is required')\n            }\n\n            console.info('strategy: %s', this.strategy || 'default')\n\n            if (this.media) {\n\n                console.log('media', this.media)\n\n                if (this.media) {\n                    this.media.forEach(\n                        (media: InterventionRequestFormat): void => {\n                            if (media.srcset) {\n                                media.srcset.forEach(\n                                    (srcset: InterventionRequestStrategyFormat): void => {\n                                        if (!srcset.format) {\n                                            console.warn('wrong media configuration: missing srcset.format property')\n                                        }\n                                    }\n                                )\n                            }\n                        }\n                    )\n                }\n            }\n\n            console.log(this.el)\n            console.groupEnd()\n        }\n\n        if (this.src) {\n            if (this.mimeType) {\n                switch (this.mimeType) {\n                    case 'image/heif':\n                    case 'image/heic':\n                    case 'image/avif':\n                    case 'image/webp':\n                    case 'image/jpeg':\n                    case 'image/png':\n                    case 'image/gif':\n                    case 'image/bmp':\n                        this.component = 'intervention-request-picture'\n                        break;\n\n                    case 'image/svg':\n                    case 'image/svg+xml':\n                        this.component = 'intervention-request-svg'\n                        break;\n\n                    default:\n                        this.component = 'intervention-request-iframe'\n                        break;\n                }\n            } else {\n                switch (extractFileExtension(this.src)) {\n                    case 'webp':\n                    case 'jpg':\n                    case 'heif':\n                    case 'heic':\n                    case 'avif':\n                    case 'jpeg':\n                    case 'png':\n                    case 'gif':\n                    case 'bmp':\n                        this.component = 'intervention-request-picture'\n                        break;\n\n                    case 'svg':\n                        this.component = 'intervention-request-svg'\n                        break;\n\n                    default:\n                        this.component = 'intervention-request-iframe'\n                        break;\n                }\n            }\n        }\n\n        if (this.noProcess) {\n            this.strategy = 'noprocess'\n        }\n\n        this.component = this.embed ? 'intervention-request-iframe' : this.component\n    }\n\n    /**\n     * Component will render\n     * Component lifecycle method\n     * @return void\n     */\n    componentWillRender (): void {\n        /**\n         * Set defaults\n         */\n        this.strategy = this.strategy || (window.interventionRequestJS && window.interventionRequestJS.strategy ? window.interventionRequestJS.strategy : 'default')\n        this.baseUrl = this.baseUrl || (window.interventionRequestJS && window.interventionRequestJS.baseUrl ? window.interventionRequestJS.baseUrl : undefined)\n        this.forceIo = this.forceIo || (window.interventionRequestJS && window.interventionRequestJS.forceIo ? window.interventionRequestJS.forceIo : undefined)\n        this.loading = this.loading || (window.interventionRequestJS && window.interventionRequestJS.loading ? window.interventionRequestJS.loading : 'auto')\n    }\n\n    /**\n     * Component render\n     * Component lifecycle method\n     * @return HTMLInterventionRequestElement\n     */\n    render(): HTMLInterventionRequestElement {\n        return (\n            <Host class={ this.classnames }>\n                <slot name=\"before\" />\n                { this.src &&\n                    <this.component\n                        width={ this.width }\n                        height={ this.height }\n                        src={ this.src }\n                        alt={ this.alt }\n                        strategy={ this.strategy }\n                        baseUrl={ this.baseUrl }\n                        force-io={ this.forceIo }\n                        loading={ this.loading }\n                        media={ this.media }\n                        mime-type={ this.mimeType }\n                        no-process={ this.noProcess }/>\n                }\n                <slot />\n            </Host>\n        )\n    }\n}\n"],"mappings":"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"}